@page "/profile"
@attribute [Authorize]
@inject IAuthService AuthService

<AuthorizeView>
    <h3>Hi, you are logged in with <i>@context.User.Identity.Name</i>.</h3>
</AuthorizeView>

<h5>Delivery Address</h5>
<AddressForm />
<p></p>

<h5>Change Password</h5>

<EditForm Model="request" OnValidSubmit="ChangePasswordAsync">
    <DataAnnotationsValidator></DataAnnotationsValidator>
        <div class="mb-3">
            <label for="password">Password</label>
            <InputText id="password" @bind-Value="request.Password" class="form-control" type="password" />
            <ValidationMessage For="@(() => request.Password)" />
        </div>
        <div class="mb-3">
            <label for="confirmepassword">Confirm Password</label>
            <InputText id="confirmepassword" @bind-Value="request.ConfirmPassword" class="form-control" type="password" />
            <ValidationMessage For="@(() => request.ConfirmPassword)" />
        </div>
        <button type="submit" class="btn-primary">Apply</button>    
</EditForm>
@message

@code {
    private UserChangePassword request = new UserChangePassword();
    private string message = string.Empty;

    private async Task ChangePasswordAsync()
    {
        var result = await AuthService.ChangePasswordAsync(request);
        message = result.Message;
    }

}
